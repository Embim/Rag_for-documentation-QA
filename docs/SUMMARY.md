# –†–µ–∑—é–º–µ —É–ª—É—á—à–µ–Ω–∏–π main_pipeline.py

## üéØ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —Ä–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

‚úÖ **–¢–µ–ø–µ—Ä—å –Ω–µ –Ω—É–∂–Ω–æ –∫–∞–∂–¥—ã–π —Ä–∞–∑ —Å–æ–∑–¥–∞–≤–∞—Ç—å –±–∞–∑—É –∑–Ω–∞–Ω–∏–π –∑–∞–Ω–æ–≤–æ!**

#### –†–µ–∂–∏–º 1: –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –±–∞–∑—ã (–æ–¥–∏–Ω —Ä–∞–∑, Weaviate-only, streaming)
```bash
python main_pipeline.py build
```
–ò–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ã –≤ Weaviate (–≤–µ–∫—Ç–æ—Ä + BM25), –∞ –ª–æ–∫–∞–ª—å–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–æ–ª—å–∫–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —á–∞–Ω–∫–æ–≤ –≤ `data/processed/chunks.pkl`. –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –∏–ª–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö.

#### –†–µ–∂–∏–º 2: –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ (–º–Ω–æ–≥–æ —Ä–∞–∑)
```bash
python main_pipeline.py search
python main_pipeline.py search --limit 10  # –¢–µ—Å—Ç –Ω–∞ 10 –≤–æ–ø—Ä–æ—Å–∞—Ö
```
–ó–∞–≥—Ä—É–∂–∞–µ—Ç –≥–æ—Ç–æ–≤—É—é –±–∞–∑—É –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤–æ–ø—Ä–æ—Å—ã. –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å —Å–∫–æ–ª—å–∫–æ —É–≥–æ–¥–Ω–æ —Ä–∞–∑!

#### –†–µ–∂–∏–º 3: –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª
```bash
python main_pipeline.py all
python main_pipeline.py all --force --limit 50
```
Build + Search –≤–º–µ—Å—Ç–µ (–∫–∞–∫ –±—ã–ª–æ —Ä–∞–Ω—å—à–µ).

## üìä –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### –î–æ —É–ª—É—á—à–µ–Ω–∏–π:
```bash
python main_pipeline.py  # –ö–∞–∂–¥—ã–π —Ä–∞–∑: build (20 –º–∏–Ω) + search (3 —á–∞—Å–∞)
```
‚ùå –î–æ–ª–≥–æ
‚ùå –ù–µ–ª—å–∑—è –±—ã—Å—Ç—Ä–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
‚ùå –ù–µ–ª—å–∑—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

### –ü–æ—Å–ª–µ —É–ª—É—á—à–µ–Ω–∏–π:
```bash
# –û–¥–∏–Ω —Ä–∞–∑ (20 –º–∏–Ω—É—Ç)
python main_pipeline.py build

# –ú–Ω–æ–≥–æ —Ä–∞–∑ (–æ—Ç 1 –º–∏–Ω—É—Ç—ã –¥–æ 3 —á–∞—Å–æ–≤)
python main_pipeline.py search --limit 10   # –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç
python main_pipeline.py search --limit 100  # –°—Ä–µ–¥–Ω–∏–π —Ç–µ—Å—Ç
python main_pipeline.py search              # –ü–æ–ª–Ω—ã–π –∑–∞–ø—É—Å–∫
```
‚úÖ –ë—ã—Å—Ç—Ä–æ
‚úÖ –£–¥–æ–±–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
‚úÖ –õ–µ–≥–∫–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å

## üöÄ –¢–∏–ø–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞
```bash
python main_pipeline.py build   # 20 –º–∏–Ω—É—Ç
python main_pipeline.py search  # 3 —á–∞—Å–∞
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –æ—Ç–ª–∞–¥–∫–∞
```bash
# –ë–∞–∑–∞ —É–∂–µ —Å–æ–∑–¥–∞–Ω–∞, —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–µ–º —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
python main_pipeline.py search --limit 10  # 1-2 –º–∏–Ω—É—Ç—ã
# –ú–µ–Ω—è–µ–º config.py
python main_pipeline.py search --limit 10  # 1-2 –º–∏–Ω—É—Ç—ã
# –ü–æ–≤—Ç–æ—Ä—è–µ–º...
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ò–∑–º–µ–Ω–∏–ª–∏—Å—å –¥–∞–Ω–Ω—ã–µ (websites.csv)
```bash
python main_pipeline.py build --force  # –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –±–∞–∑—É
python main_pipeline.py search         # –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: Production –∑–∞–ø—É—Å–∫
```bash
# –ë–∞–∑–∞ —É–∂–µ —Å–æ–∑–¥–∞–Ω–∞ –∏ –∞–∫—Ç—É–∞–ª—å–Ω–∞
python main_pipeline.py search  # –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã
```

## üõ†Ô∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. GPU –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
```
[GPU] –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è: NVIDIA ...
      CUDA –≤–µ—Ä—Å–∏—è: 12.1
      Batch size: 128
```

### 2. Weaviate –ø–æ–¥–¥–µ—Ä–∂–∫–∞ (–≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫ –∏–∑ –∫–æ—Ä–æ–±–∫–∏)
```bash
docker-compose up -d
python main_pipeline.py build
python main_pipeline.py search
```

### 3. –ü–æ–ª–µ–∑–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
- `docs/commands.md` ‚Äî –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã (build/search/all/evaluate)
- `docs/process.md` ‚Äî –ø–æ—Ç–æ–∫–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å –∏ –ø–æ–∏—Å–∫
- `docs/modules.md` ‚Äî –æ–±–∑–æ—Ä –º–æ–¥—É–ª–µ–π
- `docs/server_setup_venv.md` ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –∏ venv

## üìà –≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏

### –ü—Ä–∏–º–µ—Ä: –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

**–ë—ã–ª–æ (–ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏):**
```
–ò–∑–º–µ–Ω–∏—Ç—å config.py ‚Üí python main_pipeline.py ‚Üí 3 —á–∞—Å–∞ 20 –º–∏–Ω—É—Ç
```

**–°—Ç–∞–ª–æ:**
```
–ò–∑–º–µ–Ω–∏—Ç—å config.py ‚Üí python main_pipeline.py search --limit 10 ‚Üí 1-2 –º–∏–Ω—É—Ç—ã
```

**–≠–∫–æ–Ω–æ–º–∏—è: ~200x –±—ã—Å—Ç—Ä–µ–µ –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö —Ç–µ—Å—Ç–æ–≤!**

## üìù –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π workflow:

```bash
# –î–µ–Ω—å 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞
python main_pipeline.py build

# –î–µ–Ω—å 2-N: –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã
while true; do
    # –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ config.py
    python main_pipeline.py search --limit 10
    # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    head outputs/submission.csv
done

# –§–∏–Ω–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫
python main_pipeline.py search
```

### –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–¥–µ–∏:

```bash
# –£–∂–µ –µ—Å—Ç—å –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π
python main_pipeline.py search --limit 5  # 30-60 —Å–µ–∫—É–Ω–¥
```

### Production –∑–∞–ø—É—Å–∫:

```bash
# –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –±–∞–∑–∞ –∞–∫—Ç—É–∞–ª—å–Ω–∞
python main_pipeline.py build --force  # –ï—Å–ª–∏ –Ω—É–∂–Ω–æ

# –ü–æ–ª–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
python main_pipeline.py search
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–°–º. —Ç–∞–∫–∂–µ:
- `docs/project.md` ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (Weaviate-only, streaming)
- `docs/OPTIMIZATION_GUIDE.md` ‚Äî –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏

## ‚úÖ –ò—Ç–æ–≥–æ

**–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å:**
- ‚úÖ –ë—ã—Å—Ç—Ä–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (--limit)
- ‚úÖ –†–∞–∑–¥–µ–ª—å–Ω—ã–µ —Ä–µ–∂–∏–º—ã (build/search)
- ‚úÖ –≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏ (–¥–æ 200x)
- ‚úÖ –£–¥–æ–±—Å—Ç–≤–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ GPU –∏–∑ –∫–æ—Ä–æ–±–∫–∏
- ‚úÖ Weaviate-only –≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫

**–ë–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–æ:**
- ‚ùå –ñ–¥–∞—Ç—å 20 –º–∏–Ω—É—Ç –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ç–µ—Å—Ç–µ
- ‚ùå –ü–µ—Ä–µ—Å–æ–∑–¥–∞–≤–∞—Ç—å –±–∞–∑—É –ø–æ—Å—Ç–æ—è–Ω–Ω–æ
- ‚ùå –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
- ‚ùå –ì–∞–¥–∞—Ç—å –∫–∞–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

---

**–ù–∞—á–Ω–∏—Ç–µ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å:**
```bash
python main_pipeline.py build
python main_pipeline.py search --limit 10
```

–£–¥–∞—á–∏! üöÄ

